\section{Simulation}
\label{sec:simulation}

We verify SCALAR through simulation of the calibration procedure. The simulation is conducted by using Robot Operating System and Gazebo where the robot model, the \ac{lrf}, and the three planes can be simulated.  
As shown in \fref{fig:robot_setup}, three perpendicular planes are located around the robot, and the robot is moved such that the \ac{lrf} ray intersects each plane. Simulated data from the \ac{lrf} can be obtained and Gaussian noise with zero mean and standar deviation $\sigma_{\rm{noise}}$ can be added to the data. The data is then used as input to the calibration procedure. 

After the calibration procedure, the robot is moved to 10000 random poses to evaluate the proposed calibration method. Let ${^B}\vb*{T}_{L,j,true}$ and ${^B}\vb*{T}_{L,j,model}$ be the true and calibrated pose of the \ac{lrf} frame w.r.t. the robot base frame at the robot pose index $j$, respectively, then the error of the calibrated model can be computed as follows. 
\begin{equation}
\Delta \vb*{T}_j =  {{^B}\vb*{T}_{L,j,model}}^{-1} \cdot\; {^B}\vb*{T}_{L,j,true}
\end{equation}
Let $\delta t_{uv}$ be the element of $\Delta \vb*{T}_j$ with the subscript $u$ and $v$ refer to the row and column index, then the position error at the robot pose index $j$, $\delta p_j$, can be computed by
\begin{equation}
\delta p_j = \sqrt{\delta t_{14}^2 + \delta t_{24}^2 + \delta t_{34}^2} \quad .
\end{equation}
Let $\delta \vb*{R}_j$ be the rotation part of the homogeneous transformation matrix $\Delta \vb*{T}_j$. $\delta \vb*{R}_j$ can be represented by using an axis-angle notation, $[r_{j,1}\quad r_{j,2}\quad r_{j,3}\quad \delta \theta_j]$. We use $\delta\theta_j$ as the orientation error at the robot pose index $j$.  $\delta\theta_j$ can be seen as the amount of rotation necessary to rotate the calibrated pose to the true pose. The errors $\delta p_j$ and $\delta\theta_j$ are then averaged over the 10000 random poses.

The simulated robot's kinematic model is considered as having the true kinematic parameters, and the initial kinematic model is generated by introducing random Gaussian errors to the true parameters within the range of $\pm$ 2mm and $\pm$ 1$^o$ for the linear and angular parameters, respectively. Note that the initial model's errors are intentionally set to be large to illustrate the robustness of the calibration method. The average position and orientation errors of this initial kinematic model as compared to the true model are 21mm and 4$^o$. We run the calibration procedure to improve the initial kinematic model with $3N$ = 120, $M$ = 100 and $\sigma_{\rm{noise}}$ = 0.1mm, and the resulting calibrated kinematic model has the position and orientation errors reduced to 0.1mm and 0.02$^o$.

Next, we evaluate the effect of the measurement noise, the number of poses ($N$) and points ($M$), and the plane parameters' initial estimate on the calibration errors. 


\begin{figure}[t]
  \centering
  \subfloat{\includegraphics[height=40mm]{laser_pos}}
  \subfloat{\includegraphics[height=40mm]{laser_ori}}
  \caption{Effect of the measurement noise towards the position and orientation error} 
  \label{fig:laser_noise}
\end{figure}


\begin{figure}[t]
  \centering
  \subfloat{\includegraphics[height=40mm]{num_of_poses_pos}}
  \subfloat{\includegraphics[height=40mm]{num_of_poses_ori}}
  \caption{Effect of the number of poses towards the position and orientation error} 
  \label{fig:num_of_poses}
\end{figure}


\begin{figure}[t]
  \centering
  \subfloat{\includegraphics[height=40mm]{num_of_points_pos}}
  \subfloat{\includegraphics[height=40mm]{num_of_points_ori}}
  \caption{Effect of the number of points towards the position and orientation error} 
  \label{fig:num_of_points}
\end{figure}

\begin{figure}[t]
  \centering
  \subfloat{\includegraphics[height=40mm]{plane_param_linear_pos}}
  \subfloat{\includegraphics[height=40mm]{plane_param_linear_ori}}
  \caption{Effect of the plane parameters initial position estimate error towards the position and orientation error} 
  \label{fig:plane_params_linear}
\end{figure}

\begin{figure}[t]
  \centering
  \subfloat{\includegraphics[height=40mm]{plane_param_angular_pos}}
  \subfloat{\includegraphics[height=40mm]{plane_param_angular_ori}}
  \caption{Effect of the plane parameters initial orientation estimate error towards the position and orientation error} 
  \label{fig:plane_params_angular}
\end{figure}




\subsection{Effect of the measurement noise}
\label{sec:meas_accuracy}
The accuracy of the calibration procedure greatly depends on the accuracy of the measurement system, which is affected by the noise on the data. In this section, Gaussian noises with zero means and varying standard deviations $\sigma_{\rm{noise}}$ are added to the measurement data in the simulation, and its effect on the calibration errors is shown in \fref{fig:laser_noise}. As $\sigma_{\rm{noise}}$ decreases, the calibration errors decrease. At $\sigma_{\rm{noise}}$ = 0.1mm, the position and orientation errors are around 0.1mm and 0.02$^o$, respectively. For the subsequent sections, $\sigma_{\rm{noise}}$ is set at 0.1mm. 

\subsection{Effect of the number of calibration poses and the number of points}
\label{sec:calib_poses}
For each plane, the robot is moved to $N$ poses, so in total we have $3N$ calibration poses. At each pose, we select $M$ data points from the \ac{lrf} data. In this section we evaluate the effect of $3N$ and $M$ to the calibration errors. In \fref{fig:num_of_poses}, it can be seen that as the number of poses $3N$ increases, the error decreases until around $3N$=60, beyond which it does not change much. It can be concluded that 60 robot poses are sufficient to calibrate the robot model accurately. 


Similarly, we can see from \fref{fig:num_of_points} that as $M$ increases the calibration errors decrease. After around 10 points, the calibration errors do not change significantly. Therefore, although an \ac{lrf} can give more than 300 data points per robot pose, using more than 10-20 points does not improve the calibration significantly. 



\subsection{Effect of the plane parameters' initial estimate}
\label{sec:plane_params}
One of the advantages of SCALAR is that the planes parameters do not need to be precisely known. Here we vary the planes parameters estimate to demonstrate the robustness of our method. The initial estimates of the normals and the positions of the planes are disturbed by as much as 30$^o$ and 65mm, as shown in \fref{fig:plane_params_linear} and \fref{fig:plane_params_angular}. From the figure, it can be seen that the position and orientation error are not affected by the errors in the planes parameters initial estimate. In fact, after calibration, the planes' parameters in the calibrated model approach the true parameters within 0.1mm and 0.02$^o$.





