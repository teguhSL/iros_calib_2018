\section{Simulation}
\label{sec:simulation}

The proposed method is verified through simulation of the calibration procedure. The simulation is conducted by using Robot Operating System and Gazebo, where the robot model, the \ac{lrf}, and the three planes can be simulated.  
As shown in \fref{fig:robot_setup}, three perpendicular planes are located around the robot, and the robot is moved such that the \ac{lrf} ray intersects each of the plane. Simulated data from the \ac{lrf} can be obtained, and Gaussian noise can even be added. The data is then used as input to the calibration procedure. 

After the calibration procedure, the robot is moved to 1000 random poses to evaluate the proposed calibration method. Let $\vb*{{^B}T_{L,j,true}}$ and $\vb*{{^B}T_{L,j,model}}$ be the true and calibrated pose of the \ac{lrf} frame w.r.t. the robot base at the robot pose index j, respectively, then the error can be computed as follows. 
\begin{equation}
\Delta T_j =  (\vb*{{^B}T_{L,j,model}})^{-1} \vb*{{^B}T_{L,j,true}}
\end{equation}
Let $\delta_{uv}$ be the element of $\Delta T_j$, then the position error at robot pose index $j$, $\delta p_j$, can be computed by
\begin{equation}
\delta p_j = \sqrt{\delta_{14}^2 + \delta_{24}^2 + \delta_{34}^2}
\end{equation}.
Let $\delta R_j$ be the rotation part of the homogeneous transformation matrix $\Delta T_j$. $\delta R_j$ can be represented by using an axis-angle notation, $[r_{j,1}\; r_{j,2}\; r_{j,3}\; \delta \theta_j]$. $\delta\theta_j$ is the orientation error at robot pose index $j$ (it can be seen as the amount of rotation necessary to turn the calibrated pose to the true pose). 

The simulated robot kinematics model is considered as having the true kinematics parameters, and the initial kinematics model is generated by introducing random gaussian errors to the true parameters within the range of $\pm$ 2mm and $\pm$ 1$^o$ for the linear and angular parameters, respectively. Note that the errors are intentionally set to be large to illustrate the robustness of the calibration method. By using the proposed error formulation, the average errors of this initial kinematics model as compared to the true model are 21mm and 4$^o$.


\subsection{The effect of the measurement noise}
\label{sec:meas_accuracy}
The accuracy of the calibration procedure greatly depends on the accuracy of the measurement system. In this section, different level of noises are added to the measurement data in the simulation, and its effect on the calibration accuracy is shown in \fref{fig:laser_accuracy}. As the noises decreases, the calibration accuracy improves. At 0.1mm noise, the position error and the orientation error are around 0.1mm and 0.02$^o$, respectively. For the subsequent sections, the noise is set at 0.1mm. 
\begin{figure}[h]
  \centering
  \subfloat{\includegraphics[height=40mm]{laser_pos}}
  \subfloat{\includegraphics[height=40mm]{laser_ori}}
  \caption{Effect of the measurement noise towards the position and orientation error} 
  \label{fig:laser_accuracy}
\end{figure}


\subsection{The effect of the number of calibration poses}
\label{sec:calib_poses}
In \fref{fig:num_of_poses}, it can be seen that as the number of poses $N$ increases, the error decreases until around N=60, beyond which it does not change much. It can be concluded that 60 robot poses are sufficient to calibrate the robot model accurately. 

\begin{figure}[h]
  \centering
  \subfloat{\includegraphics[height=40mm]{num_of_poses_pos}}
  \subfloat{\includegraphics[height=40mm]{num_of_poses_ori}}
  \caption{Effect of the number of poses towards the position and orientation error} 
  \label{fig:num_of_poses}
\end{figure}

In addition, we also vary $M$, the number of points from the \ac{lrf} data per robot pose that are used for calibration \fref{fig:num_of_points}. Note that after around 10 points, the calibration result does not improve significantly. Therefore, although an \ac{lrf} can give more than 300 data points per robot pose, using more than 10-20 points does not improve the calibration by much. 

\begin{figure}[h]
  \centering
  \subfloat{\includegraphics[height=40mm]{num_of_points_pos}}
  \subfloat{\includegraphics[height=40mm]{num_of_points_ori}}
  \caption{Effect of the number of points towards the position and orientation error} 
  \label{fig:num_of_points}
\end{figure}


\subsection{The effect of the plane parameters' initial estimate}
\label{sec:plane_params}
One of the advantage of SCALAR is that the planes parameters do not need to be precisely known. Here we vary the planes parameters estimate to demonstrate the robustness of our method. The estimated normals and position of the planes are disturbed by as much as 30$^o$ and 65mm, as shown in \fref{fig:plane_params}. From the figure, it can be seen that errors in the planes' parameters estimate do not affect the calibration accuracy at all. In fact, after calibration, the planes' parameters in the calibrated model approach the true parameters within 0.1mm and 0.02$^o$.


\begin{figure}[h]
  \centering
  \subfloat{\includegraphics[height=40mm]{plane_param_pos}}
  \subfloat{\includegraphics[height=40mm]{plane_param_ori}}
  \caption{Effect of the accuracy of the plane parameters initial estimate towards the position and orientation error} 
  \label{fig:plane_params}
\end{figure}



